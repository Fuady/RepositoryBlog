<!DOCTYPE html>
<html lang="en-us">

  <head>
  <meta charset="utf-8">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <title>E-commerce data analysis</title>
  <meta name="author" content="A.M.Fuady" />
  
  
  
  
  <meta name="keywords" content="R, visualization, programming">
  
  
  <meta name="description" content="">

  <meta name="generator" content="Hugo 0.59.1" />

  
  <link href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,700,800' rel='stylesheet' type='text/css'>

  
  <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.11.2/css/all.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  
  <link href="/css/animate.css" rel="stylesheet">

  
  
    <link href="/css/style.green.css" rel="stylesheet" id="theme-stylesheet">
  

  
  <link href="/css/custom.css" rel="stylesheet">

  
  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png" />

  
  <link href="/css/owl.carousel.css" rel="stylesheet">
  <link href="/css/owl.theme.css" rel="stylesheet">

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Angga Fuady Blog">

  
  
  
  
  
  
  
  <meta property="og:locale" content="en_us">
  <meta property="og:site_name" content="Angga Fuady Blog">
  <meta property="og:title" content="E-commerce data analysis">
  <meta property="og:type" content="article">
  <meta property="og:url" content="/blog/2019/11/19/2019-11-19-e-commerce-data-analysis/" />
  <meta property="og:description" content="">
  <meta property="og:image" content="/img/banners/banner-1.jpg">
  <meta property="og:image:type" content="image/jpg">
  
  
  
    <meta property="og:image:width" content="1000">
    <meta property="og:image:height" content="750">
  
  
  <meta property="og:updated_time" content="2019-11-19T00:00:00Z">
  
    
    
    <meta property="article:section" content="analysis data">
    <meta property="article:tag" content="R">
    <meta property="article:tag" content="visualization">
    <meta property="article:tag" content="programming">
    
    
    <meta property="article:published_time" content="2019-11-19T00:00:00Z">
    <meta property="article:modified_time" content="2019-11-19T00:00:00Z">
  

  
  <meta name="twitter:card" content="summary_large_image">
  
  <meta name="twitter:title" content="E-commerce data analysis">
  
  <meta name="twitter:image" content="/img/banners/banner-1.jpg">
  
  <meta name="twitter:description" content="">
  

</head>


  <body>

    <div id="all">

        <header>

          <div class="navbar-affixed-top" data-spy="affix" data-offset-top="200">

    <div class="navbar navbar-default yamm" role="navigation" id="navbar">

        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand home" href="/">
                    <img src="/img/amf_logo.png" alt="E-commerce data analysis logo" class="hidden-xs hidden-sm">
                    <img src="/img/amf_smalllogo.png" alt="E-commerce data analysis logo" class="visible-xs visible-sm">
                    <span class="sr-only">E-commerce data analysis - go to homepage</span>
                </a>
                <div class="navbar-buttons">
                    <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse" data-target="#navigation">
                      <span class="sr-only">Toggle Navigation</span>
                        <i class="fas fa-align-justify"></i>
                    </button>
                </div>
            </div>
            

            <div class="navbar-collapse collapse" id="navigation">
                <ul class="nav navbar-nav navbar-right">
                  
                  
                  
                  <li class="dropdown">
                    
                    <a href="/">Home</a>
                    
                  </li>
                  
                  
                  <li class="dropdown active">
                    
                    <a href="/blog/">Blog</a>
                    
                  </li>
                  
                  
                  <li class="dropdown">
                    
                    <a href="tentang">Tentang Penulis</a>
                    
                  </li>
                  
                </ul>
            </div>
            

            <div class="collapse clearfix" id="search">

                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search">
                        <span class="input-group-btn">

                    <button type="submit" class="btn btn-template-main"><i class="fas fa-search"></i></button>

                </span>
                    </div>
                </form>

            </div>
            

        </div>
    </div>
    

</div>




        </header>

        <div id="heading-breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h1>E-commerce data analysis</h1>
            </div>
        </div>
    </div>
</div>


        <div id="content">
            <div class="container">

                <div class="row">

                    

                    <div class="col-md-9" id="blog-post">

                        <p class="text-muted text-uppercase mb-small text-right">By <a href="#">A.M.Fuady</a> | November 19, 2019</p>

                        <div id="post-content">
                          


<p>Hai, Di tulisan kali ini saya akan mencoba menganalisis data e-commmerce. Teman2 bisa mendownload datanya <a href="">disini</a></p>
<div id="loading-libraries" class="section level2">
<h2>Loading libraries</h2>
<pre class="r"><code>library(dplyr)
library(magrittr)
library(Hmisc)
library(lubridate)
library(caret)
library(GGally)
library(reshape2)
library(recommenderlab)</code></pre>
</div>
<div id="loading-data" class="section level2">
<h2>Loading data</h2>
<pre class="r"><code>marketing_spend &lt;- read.csv(&quot;~/RepositoryBlog/data/Marketing_Spend.csv&quot;)
key_sku &lt;- read.csv(&quot;~/RepositoryBlog/data/KEY_SKU.csv&quot;)
online &lt;- read.csv(&quot;~/RepositoryBlog/data/Online.csv&quot;)
retail &lt;- read.csv(&quot;~/RepositoryBlog/data/Retail.csv&quot;)</code></pre>
</div>
<div id="data-pre-processing" class="section level2">
<h2>Data pre-processing</h2>
<pre class="r"><code>dim(marketing_spend)</code></pre>
<pre><code>## [1] 365   3</code></pre>
<pre class="r"><code>dim(key_sku)</code></pre>
<pre><code>## [1] 1178    2</code></pre>
<pre class="r"><code>dim(online)</code></pre>
<pre><code>## [1] 54144    10</code></pre>
<pre class="r"><code>dim(retail)</code></pre>
<pre><code>## [1] 181247      4</code></pre>
<p>Renaming colnames of each dataframe.</p>
<pre class="r"><code>names(marketing_spend)[1] &lt;- c(&quot;Date&quot;)
names(key_sku)[1] &lt;- c(&quot;Product.SKU&quot;)
names(online) &lt;- c(&quot;Transaction.ID&quot;, &quot;Date&quot;,&quot;Product.SKU&quot;,
                   &quot;Product&quot;,&quot;Product.Category&quot;,&quot;Quantity.online&quot;,
                   &quot;Avg.price&quot;,&quot;Revenue&quot;,&quot;Tax&quot;,&quot;Delivery&quot;)
names(retail) &lt;- c(&quot;Transaction.ID&quot;,&quot;Date&quot;,&quot;StockCode&quot;,&quot;Quantity.retail&quot;)</code></pre>
<div id="marketing-spend-dataset" class="section level3">
<h3>Marketing Spend dataset</h3>
<p>Adding extra variable which decompose Date into day, month and year. <code>yday</code> is the day count from 1st of January.</p>
<pre class="r"><code>marketing_spend$Date &lt;- as.character(marketing_spend$Date)

marketing_spend %&lt;&gt;% mutate(
  day = substr(marketing_spend$Date, nchar(marketing_spend$Date)-1, nchar(marketing_spend$Date)),
  month = substr(marketing_spend$Date, nchar(marketing_spend$Date)-4, nchar(marketing_spend$Date)-3),
  year = substr(marketing_spend$Date, nchar(marketing_spend$Date)-9, nchar(marketing_spend$Date)-6),
  yday = yday(marketing_spend$Date)
)
summary(marketing_spend)</code></pre>
<pre><code>##      Date           Offline.Spend   Online.Spend        day           
##  Length:365         Min.   : 500   Min.   : 320.2   Length:365        
##  Class :character   1st Qu.:2500   1st Qu.:1258.6   Class :character  
##  Mode  :character   Median :3000   Median :1881.9   Mode  :character  
##                     Mean   :2844   Mean   :1905.9                     
##                     3rd Qu.:3500   3rd Qu.:2435.1                     
##                     Max.   :5000   Max.   :4556.9                     
##     month               year                yday    
##  Length:365         Length:365         Min.   :  1  
##  Class :character   Class :character   1st Qu.: 92  
##  Mode  :character   Mode  :character   Median :183  
##                                        Mean   :183  
##                                        3rd Qu.:274  
##                                        Max.   :365</code></pre>
</div>
<div id="key-skus-dataset" class="section level3">
<h3>Key SKUs dataset</h3>
<pre class="r"><code>key_sku$Product.SKU &lt;- as.character(key_sku$Product.SKU)
summary(key_sku)</code></pre>
<pre><code>##  Product.SKU          StockCode    
##  Length:1178        Min.   :10002  
##  Class :character   1st Qu.:21041  
##  Mode  :character   Median :21496  
##                     Mean   :21145  
##                     3rd Qu.:21946  
##                     Max.   :22314</code></pre>
</div>
<div id="retail-dataset" class="section level3">
<h3>Retail dataset</h3>
<pre class="r"><code>## retail
retail$Date &lt;- as.character(retail$Date)
retail %&lt;&gt;% mutate(
  day = substr(retail$Date, nchar(retail$Date)-1, nchar(retail$Date)),
  month = substr(retail$Date, nchar(retail$Date)-4, nchar(retail$Date)-3),
  year = substr(retail$Date, nchar(retail$Date)-9, nchar(retail$Date)-6),
  yday = yday(retail$Date),
  workday = wday(ymd(Date))
)

summary(retail)</code></pre>
<pre><code>##  Transaction.ID       Date             StockCode     Quantity.retail  
##  Min.   :536598   Length:181247      Min.   :10002   Min.   :  1.000  
##  1st Qu.:545700   Class :character   1st Qu.:21135   1st Qu.:  1.000  
##  Median :557026   Mode  :character   Median :21672   Median :  1.000  
##  Mean   :557388                      Mean   :21356   Mean   :  4.561  
##  3rd Qu.:568703                      3rd Qu.:22055   3rd Qu.:  2.000  
##  Max.   :580137                      Max.   :22314   Max.   :900.000  
##      day               month               year                yday      
##  Length:181247      Length:181247      Length:181247      Min.   :  1.0  
##  Class :character   Class :character   Class :character   1st Qu.: 95.0  
##  Mode  :character   Mode  :character   Mode  :character   Median :196.0  
##                                                           Mean   :193.2  
##                                                           3rd Qu.:300.0  
##                                                           Max.   :365.0  
##     workday     
##  Min.   :1.000  
##  1st Qu.:2.000  
##  Median :5.000  
##  Mean   :4.282  
##  3rd Qu.:6.000  
##  Max.   :7.000</code></pre>
</div>
<div id="online-dataset" class="section level3">
<h3>Online dataset</h3>
<pre class="r"><code>online$Date &lt;- as.character(online$Date)
online %&lt;&gt;% mutate(
  day = substr(online$Date, nchar(online$Date)-1, nchar(online$Date)),
  month = substr(online$Date, nchar(online$Date)-3, nchar(online$Date)-2),
  year = substr(online$Date, nchar(online$Date)-7, nchar(online$Date)-4),
  yday = yday(ymd(online$Date)),
  workday = wday(ymd(Date)),
  amount_spend = Quantity.online*Avg.price
)

online$Product.SKU &lt;- as.character(online$Product.SKU)
online$Product &lt;- as.character(online$Product)
online$Product.Category &lt;- as.character(online$Product.Category)

summary(online)</code></pre>
<pre><code>##  Transaction.ID      Date           Product.SKU          Product         
##  Min.   :16679   Length:54144       Length:54144       Length:54144      
##  1st Qu.:25332   Class :character   Class :character   Class :character  
##  Median :32548   Mode  :character   Mode  :character   Mode  :character  
##  Mean   :32337                                                           
##  3rd Qu.:39008                                                           
##  Max.   :48497                                                           
##                                                                          
##  Product.Category   Quantity.online     Avg.price         Revenue        
##  Length:54144       Min.   :  1.000   Min.   :  0.39   Min.   :    0.50  
##  Class :character   1st Qu.:  1.000   1st Qu.:  5.59   1st Qu.:   53.17  
##  Mode  :character   Median :  1.000   Median : 16.99   Median :  119.99  
##                     Mean   :  4.538   Mean   : 51.48   Mean   :  277.01  
##                     3rd Qu.:  2.000   3rd Qu.:100.91   3rd Qu.:  268.00  
##                     Max.   :900.000   Max.   :355.74   Max.   :23945.56  
##                     NA&#39;s   :5                                            
##       Tax            Delivery          day               month          
##  Min.   :  0.00   Min.   :  0.00   Length:54144       Length:54144      
##  1st Qu.:  0.00   1st Qu.:  6.00   Class :character   Class :character  
##  Median :  6.81   Median :  6.00   Mode  :character   Mode  :character  
##  Mean   : 14.73   Mean   : 10.58                                        
##  3rd Qu.: 17.84   3rd Qu.:  6.50                                        
##  Max.   :754.14   Max.   :521.36                                        
##                                                                         
##      year                yday        workday       amount_spend     
##  Length:54144       Min.   :  1   Min.   :1.000   Min.   :    0.40  
##  Class :character   1st Qu.:101   1st Qu.:2.000   1st Qu.:   11.88  
##  Mode  :character   Median :194   Median :4.000   Median :   30.38  
##                     Mean   :186   Mean   :3.964   Mean   :   87.85  
##                     3rd Qu.:269   3rd Qu.:5.000   3rd Qu.:  119.50  
##                     Max.   :365   Max.   :7.000   Max.   :10512.39  
##                                                   NA&#39;s   :5</code></pre>
<p>We found some missing values in the <code>online</code> dataset, specifically in the <code>Quantity.online</code> and <code>Product.Category</code> variable. For the <code>Product.Category</code> variable, the missing information will be fill in with <code>Uncategorized</code>.</p>
<div id="removing-missing-value-in-product.category-variable" class="section level4">
<h4>Removing missing value in <code>Product.Category</code> variable</h4>
<pre class="r"><code>online[which(is.na(online$Product.Category)),&quot;Product.Category&quot;] &lt;- c(&quot;Uncategorized&quot;)</code></pre>
</div>
<div id="removing-missing-value-in-quantity.online-variable" class="section level4">
<h4>Removing missing value in <code>Quantity.online</code> variable</h4>
<pre class="r"><code>online &lt;- online[-which(is.na(online$Quantity.online)),] # 5 missing removed</code></pre>
<p>Adding Stock code and product SKU for online and retail datasets. For these datasets, add other variable <code>store</code> to identify each products with either online or offline.</p>
<pre class="r"><code>online &lt;- merge(online, key_sku, by=&quot;Product.SKU&quot;)
retail &lt;- merge(retail,key_sku,by=&quot;StockCode&quot;)

online$store &lt;- rep(c(&quot;online&quot;), nrow(online))
retail$store &lt;- rep(c(&quot;retail&quot;), nrow(retail))</code></pre>
<p>Merge online and retail.</p>
<pre class="r"><code>online_1 &lt;- online[,c(&quot;Transaction.ID&quot;,&quot;Quantity.online&quot;,&quot;day&quot;,&quot;month&quot;,&quot;yday&quot;,&quot;workday&quot;,&quot;store&quot;)]
retail_1 &lt;- retail[,c(&quot;Transaction.ID&quot;,&quot;Quantity.retail&quot;,&quot;day&quot;,&quot;month&quot;,&quot;yday&quot;,&quot;workday&quot;,&quot;store&quot;)]
names(online_1)[2] &lt;- names(retail_1)[2] &lt;- c(&quot;Quantity&quot;)

merge.online.retail &lt;- rbind(online_1,retail_1)</code></pre>
<p>Plot number of transactions for each month. In this plot, we see the information of total number of transactions every month. The highest transaction for both online and retail in December. In both dataset, the number of transaction start to increase since september.</p>
<pre class="r"><code>ggplot(merge.online.retail %&gt;%
         group_by(Transaction.ID,month,store) %&gt;% summarise(trans.n = n()) %&gt;%
         group_by(month,store) %&gt;% summarise(trans.n.month = n() ),
       aes(month, trans.n.month,fill=store)) +
  geom_bar(stat=&quot;identity&quot;, position=position_dodge()) +
  facet_wrap(~store, nrow=2) +
  theme_set(theme_bw()) +
  theme(legend.position = &quot;none&quot;) +
  geom_text(aes(label=trans.n.month), vjust=1.6, color=&quot;white&quot;, size=3.5, position=position_dodge(0.8)) +
  scale_fill_brewer(palette=&quot;Paired&quot;) +
  scale_x_discrete(name = &quot;Month&quot;,
                   labels=c(&quot;Jan&quot;,&quot;Feb&quot;,&quot;Mar&quot;,&quot;Apr&quot;,&quot;May&quot;,&quot;Jun&quot;,&quot;Jul&quot;,&quot;Aug&quot;,&quot;Sept&quot;,&quot;Oct&quot;,&quot;Nov&quot;,&quot;Dec&quot;)) +
  labs( y = &quot;Number of Transaction&quot;,
        title=&quot;Number of transactions for different Months&quot;)</code></pre>
<p><img src="/blog/2019-11-19-e-commerce-data-analysis_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Specific within December, we investigate more on specific date.</p>
<pre class="r"><code>merge.dec &lt;- merge.online.retail[which(merge.online.retail$month==&quot;12&quot;),] %&gt;%
  group_by(Transaction.ID,day,store) %&gt;% summarise(trans.n = n()) %&gt;%
  group_by(day,store) %&gt;% summarise(trans.n.month = n())

add.merge.dec &lt;- data.frame( day = c(&quot;04&quot;,&quot;11&quot;,&quot;18&quot;,&quot;25&quot;,&quot;30&quot;) , store= rep(c(&quot;retail&quot;),5) ,  trans.n.month = rep(0,5))

ggplot( rbind(as.data.frame(merge.dec), add.merge.dec),
       aes(day, trans.n.month,fill=store)) +
  geom_bar(stat=&quot;identity&quot;) +
  facet_wrap(~store, nrow=2)+
  theme_set(theme_bw()) +
  geom_text(aes(label=trans.n.month), vjust=1.6, color=&quot;white&quot;, size=3.5, position=position_dodge(0.8)) +
  scale_fill_brewer(palette=&quot;Paired&quot;) +
  theme(axis.ticks.x = element_blank(), legend.position = &quot;none&quot;) +
  labs( x=&quot;Date&quot;, y = &quot;Number of Transaction&quot;,
        title=&quot;Number of transactions for different Dates in December&quot;)</code></pre>
<p><img src="/blog/2019-11-19-e-commerce-data-analysis_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Plot the total number of transactions for each working day.</p>
<pre class="r"><code>ggplot(merge.online.retail %&gt;%
         group_by(Transaction.ID,workday,store) %&gt;% summarise(trans.n = n()) %&gt;%
         group_by(workday,store) %&gt;% summarise(trans.n.month = n() ),
       aes(workday, trans.n.month,fill=store)) +
  geom_bar(stat=&quot;identity&quot;) +
  facet_wrap(~store, nrow=2) +
  theme_set(theme_bw()) +
  geom_text(aes(label=trans.n.month), vjust=1.6, color=&quot;white&quot;, size=3.5, position=position_dodge(0.8)) +
  scale_fill_brewer(palette=&quot;Paired&quot;) +
  theme(axis.ticks.x = element_blank(),legend.position = &quot;none&quot;) +
  scale_x_discrete(name = &quot;Day&quot; ,limits= seq(1:7), breaks=seq(1:7), labels=c(&quot;Sun&quot;,&quot;Mon&quot;,&quot;Tue&quot;,&quot;Wed&quot;,&quot;Thur&quot;,&quot;Fri&quot;,&quot;Sat&quot;)) +
  labs( y = &quot;Number of Transaction&quot;,
        title=&quot;Number of transactions for different Days&quot;)</code></pre>
<p><img src="/blog/2019-11-19-e-commerce-data-analysis_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Plot of total marketing spend for retail and online.</p>
<pre class="r"><code>ggplot(melt(marketing_spend[which(marketing_spend$month==&quot;12&quot;),2:5]) ,aes(day, value,fill= variable))+
  geom_bar(stat=&quot;identity&quot;) +
  facet_wrap(~variable, nrow=2)+
  theme_set(theme_bw()) +
  geom_text(aes(label=value), vjust=1.6, color=&quot;white&quot;, size=3.5, position=position_dodge(0.8)) +
  scale_fill_brewer(palette=&quot;Paired&quot;) +
  theme(axis.ticks.x = element_blank(), legend.position = &quot;none&quot;) +
  labs( x=&quot;Date&quot;, y = &quot;Marketing Spend&quot;,
        title=&quot;Amount of marketing spend for different Dates in December&quot;)</code></pre>
<pre><code>## Using day, month as id variables</code></pre>
<p><img src="/blog/2019-11-19-e-commerce-data-analysis_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Plot total sales and marketing spend online in december</p>
<pre class="r"><code>data.december &lt;- merge(merge.dec[which(merge.dec$store==&quot;online&quot;),], marketing_spend[which(marketing_spend$month==&quot;12&quot;),c(&quot;day&quot;,&quot;Online.Spend&quot;)],by=&quot;day&quot;)

names(data.december)[3:4] &lt;- c(&quot;Total sales&quot;,&quot;Marketing spend&quot;)
ggplot(melt(data.december[,-2]) ,aes(day, value,fill= variable))+
  geom_bar(stat=&quot;identity&quot;) +
  facet_wrap(~variable, scale=&quot;free&quot; ,nrow=2)+
  theme_set(theme_bw()) +
  geom_text(aes(label=value), vjust=1.6, color=&quot;white&quot;, size=3) +
  scale_fill_brewer(palette=&quot;Paired&quot;) +
  theme(axis.ticks.x = element_blank(), legend.position = &quot;none&quot;) +
  labs( x=&quot;Date&quot;,
        title=&quot;Total sales and marketing spend Online in December&quot;)</code></pre>
<pre><code>## Using day as id variables</code></pre>
<p><img src="/blog/2019-11-19-e-commerce-data-analysis_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code>online %&gt;% group_by(Product.SKU,Product) %&gt;% summarise(sum.quantity = sum(Quantity.online)) %&gt;% arrange(desc(sum.quantity))%&gt;% head(5) %&gt;%
  ggplot(aes(x=reorder(Product,sum.quantity), y= sum.quantity)) +
    geom_bar(stat=&quot;identity&quot;,fill=&quot;steelblue&quot;) +
    coord_flip() +
  geom_text(aes(label=sum.quantity), hjust=1.6, color=&quot;white&quot;, size=3.5)+
  theme(axis.title.y = element_blank()) +
  labs( x=&quot;Total quantity&quot;, y = &quot;Product name&quot;,
        title=&quot;Top 5 Product Sold Online&quot;)</code></pre>
<p><img src="/blog/2019-11-19-e-commerce-data-analysis_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre class="r"><code>online %&gt;% group_by(Product.Category) %&gt;% summarise(sum.quantity = sum(Quantity.online)) %&gt;% arrange(desc(sum.quantity))%&gt;% head(5) %&gt;%
  ggplot(aes(x=reorder(Product.Category,sum.quantity), y= sum.quantity)) +
  geom_bar(stat=&quot;identity&quot;,fill=&quot;steelblue&quot;) +
  coord_flip() +
  geom_text(aes(label=sum.quantity), hjust=1.6, color=&quot;white&quot;, size=3.5)+
  theme(axis.title.y = element_blank()) +
  labs( x=&quot;Total quantity&quot;, y = &quot;Product Category&quot;,
        title=&quot;Top 5 Product Category Sold Online&quot;)</code></pre>
<p><img src="/blog/2019-11-19-e-commerce-data-analysis_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code>online %&gt;% group_by(Transaction.ID) %&gt;% summarise(total_amount_spend = sum(amount_spend)) %&gt;% arrange(desc(total_amount_spend)) %&gt;% head(5) %&gt;%
  ggplot(aes(x=reorder(Transaction.ID,total_amount_spend), y= total_amount_spend)) +
  geom_bar(stat=&quot;identity&quot;,fill=&quot;steelblue&quot;) +
  coord_flip() +
  geom_text(aes(label=total_amount_spend), hjust=1.6, color=&quot;white&quot;, size=3.5)+
  labs( x=&quot;Total amount spend per transaction&quot;, y = &quot;Total amount spend per transaction&quot;,
        title=&quot;Top 5 Total amount spend per transaction ID&quot;)</code></pre>
<p><img src="/blog/2019-11-19-e-commerce-data-analysis_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
</div>
<div id="prediction-model-per-day" class="section level3">
<h3>Prediction model per day</h3>
<pre class="r"><code>transaction.perday &lt;- online[,c(&quot;Transaction.ID&quot;,&quot;Revenue&quot;,&quot;Tax&quot;,&quot;Delivery&quot;,&quot;workday&quot;,&quot;yday&quot;)]
transaction.unique &lt;- transaction.perday[!duplicated(transaction.perday$Transaction.ID),]
sum.per.day &lt;- transaction.unique %&gt;% group_by(yday) %&gt;% summarise(sum.rev = sum(Revenue), sum.tax = sum(Tax), sum.delivery=sum(Delivery))
sum.quan.per.day &lt;- online %&gt;% group_by(yday) %&gt;%summarise(sum.quan = sum(Quantity.online))
per.day.online &lt;- merge(sum.per.day, sum.quan.per.day, by=&quot;yday&quot;)
data.per.day &lt;- merge(per.day.online,marketing_spend[,c(&quot;yday&quot;,&quot;Online.Spend&quot;)], by=&quot;yday&quot;)

my_fn &lt;- function(data, mapping, method=&quot;loess&quot;, ...){
  p &lt;- ggplot(data = data, mapping = mapping) +
    geom_point() +
    geom_smooth(method=method, ...)
  p
}</code></pre>
<p>Correlation matrix between variable of interest.</p>
<pre class="r"><code>ggpairs(data.per.day[,-1], lower = list(continuous = my_fn))</code></pre>
<p><img src="/blog/2019-11-19-e-commerce-data-analysis_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code>df.res.rev &lt;- data.frame(predictor = c(&quot;quan&quot;,&quot;tax&quot;,&quot;deli&quot;,&quot;spend&quot;,&quot;quan.tax&quot;,&quot;quan.deli&quot;,&quot;quan.spend&quot;,&quot;tax.deli&quot;,&quot;tax.spend&quot;,&quot;deli.spend&quot;,&quot;quan.tax.deli&quot;,&quot;quan.tax.spend&quot;,&quot;quan.deli.spend&quot;,&quot;tax.deli.spend&quot;,&quot;quan.tax.deli.spend&quot;),
           r.squared = c(
summary(lm(sum.rev~sum.quan, data = data.per.day))$r.squared,
summary(lm(sum.rev~sum.tax, data = data.per.day))$r.squared,
summary(lm(sum.rev~sum.delivery, data = data.per.day))$r.squared,
summary(lm(sum.rev~Online.Spend, data = data.per.day))$r.squared,
summary(lm(sum.rev~sum.quan + sum.tax, data = data.per.day))$r.squared,
summary(lm(sum.rev~sum.quan + sum.delivery, data = data.per.day))$r.squared,
summary(lm(sum.rev~sum.quan + Online.Spend, data = data.per.day))$r.squared,
summary(lm(sum.rev~sum.tax + sum.delivery, data = data.per.day))$r.squared,
summary(lm(sum.rev~sum.tax + Online.Spend, data = data.per.day))$r.squared,
summary(lm(sum.rev~sum.delivery + Online.Spend, data = data.per.day))$r.squared,
summary(lm(sum.rev~sum.quan + sum.tax + sum.delivery, data = data.per.day))$r.squared,
summary(lm(sum.rev~sum.quan + sum.tax + Online.Spend, data = data.per.day))$r.squared,
summary(lm(sum.rev~sum.quan + sum.delivery + Online.Spend, data = data.per.day))$r.squared,
summary(lm(sum.rev~sum.tax + sum.delivery + Online.Spend, data = data.per.day))$r.squared,
summary(lm(sum.rev~sum.quan + sum.tax + sum.delivery + Online.Spend, data = data.per.day))$r.squared
))

df.res.rev[order(df.res.rev$r.squared,decreasing = TRUE),]</code></pre>
<pre><code>##              predictor   r.squared
## 15 quan.tax.deli.spend 0.811779840
## 11       quan.tax.deli 0.811664237
## 12      quan.tax.spend 0.810273996
## 5             quan.tax 0.810040962
## 14      tax.deli.spend 0.635871738
## 8             tax.deli 0.635274586
## 13     quan.deli.spend 0.630650578
## 6            quan.deli 0.624893289
## 9            tax.spend 0.623293135
## 2                  tax 0.623142942
## 7           quan.spend 0.521193169
## 1                 quan 0.516273178
## 10          deli.spend 0.433581416
## 3                 deli 0.424666286
## 4                spend 0.009497018</code></pre>
<pre class="r"><code>df.res.quan &lt;- data.frame(predictor = c(&quot;tax&quot;,&quot;deli&quot;,&quot;spend&quot;,&quot;tax.deli&quot;,&quot;tax.spend&quot;,&quot;deli.spend&quot;,&quot;tax.deli.spend&quot;),
           r.squared = c(
summary(lm(sum.quan~sum.tax, data = data.per.day))$r.squared,
summary(lm(sum.quan~sum.delivery, data = data.per.day))$r.squared,
summary(lm(sum.quan~Online.Spend, data = data.per.day))$r.squared,
summary(lm(sum.quan~sum.tax + sum.delivery, data = data.per.day))$r.squared,
summary(lm(sum.quan~sum.tax + Online.Spend, data = data.per.day))$r.squared,
summary(lm(sum.quan~sum.delivery + Online.Spend, data = data.per.day))$r.squared,
summary(lm(sum.quan~sum.tax + sum.delivery + Online.Spend, data = data.per.day))$r.squared
))

df.res.quan[order(df.res.quan$r.squared,decreasing = TRUE),]</code></pre>
<pre><code>##        predictor   r.squared
## 7 tax.deli.spend 0.267057397
## 4       tax.deli 0.266277747
## 6     deli.spend 0.264755157
## 2           deli 0.263481367
## 5      tax.spend 0.168913009
## 1            tax 0.168872726
## 3          spend 0.001450041</code></pre>
<pre class="r"><code>fitControl &lt;- trainControl(method = &quot;repeatedcv&quot;,
                           number = 10,     # number of folds
                           repeats = 10)    # repeated ten times

model.rev.lm &lt;- train(sum.rev~sum.quan + sum.tax ,
                         data = data.per.day[,-1],
                         method = &quot;lm&quot;,  # now we&#39;re using the lm method
                         trControl = fitControl)
model.rev.lasso &lt;- train(sum.rev~sum.quan + sum.tax ,
                         data = data.per.day[,-1],
                         method = &quot;lasso&quot;,  # now we&#39;re using the lasso method
                         trControl = fitControl)
model.rev.ridge &lt;- train(sum.rev~sum.quan + sum.tax ,
                         data = data.per.day[,-1],
                         method = &quot;ridge&quot;,  # now we&#39;re using the ridge method
                         trControl = fitControl)
model.rev.enet &lt;- train(sum.rev~sum.quan + sum.tax ,
                         data = data.per.day[,-1],
                         method = &quot;enet&quot;,  # now we&#39;re using the enet method
                         trControl = fitControl)
model.rev.stepwise.backward &lt;- train(sum.rev~. ,
                                    data = data.per.day[,-1],
                                    tuneGrid = data.frame(nvmax = 1:4),
                                    method = &quot;leapBackward&quot;,  # now we&#39;re using the nn method
                                    trControl = fitControl)

# lm, lasso, ridge, enet, neuralnet
results.all.variable &lt;- data.frame( method = c(&quot;LM&quot;,&quot;Lasso&quot;,&quot;Ridge&quot;,&quot;ElasticNet&quot;), rbind(model.rev.lm$results[,2:4],
model.rev.lasso$results[3,2:4], # used for multicolinearity penalised with absolute value, makes coefficient exactly zero
model.rev.ridge$results[2,2:4], # used for multicolinearity penalised with square of regression coef. beta coef shrink
model.rev.enet$results[8,3:5])) # used for multicolinearity (hybrid lasso and ridge)

results.all.variable</code></pre>
<pre><code>##       method     RMSE  Rsquared      MAE
## 1         LM 2996.427 0.8146573 1852.408
## 3      Lasso 3031.100 0.8154094 1788.250
## 2      Ridge 3003.492 0.8146597 1856.127
## 6 ElasticNet 2988.311 0.8155627 1847.745</code></pre>
<pre class="r"><code>summary(model.rev.stepwise.backward$finalModel)# tax and quantity</code></pre>
<pre><code>## Subset selection object
## 4 Variables  (and intercept)
##              Forced in Forced out
## sum.tax          FALSE      FALSE
## sum.delivery     FALSE      FALSE
## sum.quan         FALSE      FALSE
## Online.Spend     FALSE      FALSE
## 1 subsets of each size up to 2
## Selection Algorithm: backward
##          sum.tax sum.delivery sum.quan Online.Spend
## 1  ( 1 ) &quot;*&quot;     &quot; &quot;          &quot; &quot;      &quot; &quot;         
## 2  ( 1 ) &quot;*&quot;     &quot; &quot;          &quot;*&quot;      &quot; &quot;</code></pre>
</div>
<div id="modeling-product-recomendation" class="section level3">
<h3>Modeling product recomendation</h3>
<pre class="r"><code>productmat &lt;- dcast(online, Transaction.ID~Product.SKU, value.var = &quot;Quantity.online&quot;, na.rm=FALSE)
productmat[1:5,1:5]</code></pre>
<pre><code>##   Transaction.ID GGOEA0CH077599 GGOEAAAB034813 GGOEAAAB034814
## 1          16679             NA             NA             NA
## 2          16680             NA             NA             NA
## 3          16681             NA             NA             NA
## 4          16682             NA             NA             NA
## 5          16684             NA             NA             NA
##   GGOEAAAB034815
## 1             NA
## 2             NA
## 3             NA
## 4             NA
## 5             NA</code></pre>
<pre class="r"><code># first user transactionID = 16679
productmat &lt;- as.matrix(productmat[,-1]) #remove TransactionID

#Convert rating matrix into a recommenderlab sparse matrix
productmat &lt;- as(productmat, &quot;realRatingMatrix&quot;)

#Normalize the data
productmat_norm &lt;- normalize(productmat)

#Create Recommender Model. &quot;UBCF&quot; stands for User-Based Collaborative Filtering
recommender_model &lt;- Recommender(productmat_norm, method = &quot;UBCF&quot;, param=list(method=&quot;Cosine&quot;,nn=10))</code></pre>
<pre><code>## Warning in .local(x, ...): x was already normalized by row!</code></pre>
<pre class="r"><code>recom &lt;- predict(recommender_model, productmat[3], n=5) # Obtain top 5 recommendations for 1st user in dataset
recom_list &lt;- as(recom, &quot;list&quot;) # convert recommenderlab object to readable list

#Obtain top 5 recommendations for transactionID 1:
list_recom &lt;- online[which(online$Product.SKU %in% unlist(recom_list)),c(&quot;Product.SKU&quot;,&quot;Product&quot;,&quot;Product.Category&quot;)]
list_recom[!duplicated(list_recom$Product.SKU),]</code></pre>
<pre><code>##        Product.SKU                         Product     Product.Category
## 1   GGOEA0CH077599      Android Hard Cover Journal Notebooks &amp; Journals
## 17  GGOEAAAB034813 Android BTTF Cosmos Graphic Tee              Apparel
## 35  GGOEAAAB034814 Android BTTF Cosmos Graphic Tee              Apparel
## 78  GGOEAAAB034815 Android BTTF Cosmos Graphic Tee              Apparel
## 109 GGOEAAAB034816 Android BTTF Cosmos Graphic Tee              Apparel</code></pre>
</div>
</div>

                        </div>
                        
                        
                        <div id="comments">
                            <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "amfuady" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                        </div>
                        

                    </div>
                    

                    

                    

                    <div class="col-md-3">

                        

                        

<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
      <h3 class="panel-title">Search</h3>
    </div>

    <div class="panel-body">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" role="search">
            <div class="input-group">
                <input type="search" name="q" class="form-control" placeholder="Search">
                <input type="hidden" name="sitesearch" value="/">
                <span class="input-group-btn">
                    <button type="submit" class="btn btn-template-main"><i class="fas fa-search"></i></button>
                </span>
            </div>
        </form>
    </div>
</div>







<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
        <h3 class="panel-title">Categories</h3>
    </div>

    <div class="panel-body">
        <ul class="nav nav-pills nav-stacked">
            
            
            <li>
                <a href="/categories/analysis-data">analysis-data (1)</a>
            </li>
            
            <li>
                <a href="/categories/r">r (1)</a>
            </li>
            
        </ul>
    </div>

</div>








<div class="panel sidebar-menu">

    <div class="panel-heading">
        <h3 class="panel-title">Tags</h3>
    </div>

    <div class="panel-body">
        <ul class="tag-cloud">
            
            
            <li>
                <a href="/tags/plot"><i class="fas fa-tags"></i> plot</a>
            </li>
            
            <li>
                <a href="/tags/programming"><i class="fas fa-tags"></i> programming</a>
            </li>
            
            <li>
                <a href="/tags/r"><i class="fas fa-tags"></i> r</a>
            </li>
            
            <li>
                <a href="/tags/r-markdown"><i class="fas fa-tags"></i> r-markdown</a>
            </li>
            
            <li>
                <a href="/tags/regression"><i class="fas fa-tags"></i> regression</a>
            </li>
            
            <li>
                <a href="/tags/visualization"><i class="fas fa-tags"></i> visualization</a>
            </li>
            
        </ul>
    </div>

</div>






                        

                    </div>
                    

                    

                </div>
                

            </div>
            
        </div>
        

        <footer id="footer">
    <div class="container">

        

        <div class="col-md-4 col-sm-6">

             
            <h4>Recent posts</h4>

            <div class="blog-entries">
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="/blog/2019/11/19/2019-11-19-e-commerce-data-analysis/">
                          
                            <img src="/img/banners/banner-1.jpg" class="img-responsive" alt="E-commerce data analysis">
                          
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="/blog/2019/11/19/2019-11-19-e-commerce-data-analysis/">E-commerce data analysis</a></h5>
                    </div>
                </div>
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="/blog/2019/07/23/2015-07-23-r-rmarkdown/">
                          
                            <img src="/img/banners/banner-2.jpg" class="img-responsive" alt="Hello R Markdown">
                          
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="/blog/2019/07/23/2015-07-23-r-rmarkdown/">Hello R Markdown</a></h5>
                    </div>
                </div>
                
            </div>

            <hr class="hidden-md hidden-lg">
             

        </div>
        

        

    </div>
    
</footer>







<div id="copyright">
    <div class="container">
        <div class="col-md-12">
            
            <p class="pull-left">Copyright (c) 2019</p>
            
            <p class="pull-right">
              Template by <a href="https://bootstrapious.com/p/universal-business-e-commerce-template">Bootstrapious</a>.
              

              Ported to Hugo by <a href="https://github.com/devcows/hugo-universal-theme">DevCows</a>.
            </p>
        </div>
    </div>
</div>





    </div>
    

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-150402048-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

<script src="//code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js"></script>

<script src="//maps.googleapis.com/maps/api/js?v=3.exp"></script>

<script src="/js/hpneo.gmaps.js"></script>
<script src="/js/gmaps.init.js"></script>
<script src="/js/front.js"></script>


<script src="/js/owl.carousel.min.js"></script>


  </body>
</html>
