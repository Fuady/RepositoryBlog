---
title: Visualisasi dengan ggplot2
banner: img/banners/Rplot_ggplot2.png
author: A.M.Fuady
date: '2019-11-20'
slug: visualisasi-dengan-ggplot2
categories: 
  - R
tags:
  - R
  - ggplot2
  - visualization
---



<p>Tulisan ini akan membahas mengenai bagaimana cara menyajikan data secara visual menggunakan package <strong>ggplot2</strong>. R memiliki beberapa system untuk membuat visualisasi, namun <strong>ggplot2</strong> merupakan salah satu package yang sering digunakan untuk menyajikan data.</p>
<p>Sebelum kita mulai, dalam tulisan kali ini saya akan menggunakan dataset <em>mpg</em> yang berada di package <strong>ggplot2</strong>. Dataset ini memuat kumpulan observasi dari 38 model mobil. Tentunya kita juga perlu memuat package <strong>ggplot2</strong> sebagai berikut:</p>
<pre class="r"><code># install package bila diperlukan
#install.packages(&quot;ggplot2&quot;)

# load package
library(ggplot2)</code></pre>
<p>Berikut ini adalah enam observasi teratas dan ringkasan dari data <em>mpg</em>:</p>
<pre class="r"><code>head(mpg)</code></pre>
<pre><code>## # A tibble: 6 x 11
##   manufacturer model displ  year   cyl trans  drv     cty   hwy fl    class
##   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1 audi         a4      1.8  1999     4 auto(~ f        18    29 p     comp~
## 2 audi         a4      1.8  1999     4 manua~ f        21    29 p     comp~
## 3 audi         a4      2    2008     4 manua~ f        20    31 p     comp~
## 4 audi         a4      2    2008     4 auto(~ f        21    30 p     comp~
## 5 audi         a4      2.8  1999     6 auto(~ f        16    26 p     comp~
## 6 audi         a4      2.8  1999     6 manua~ f        18    26 p     comp~</code></pre>
<pre class="r"><code>summary(mpg)</code></pre>
<pre><code>##  manufacturer          model               displ            year     
##  Length:234         Length:234         Min.   :1.600   Min.   :1999  
##  Class :character   Class :character   1st Qu.:2.400   1st Qu.:1999  
##  Mode  :character   Mode  :character   Median :3.300   Median :2004  
##                                        Mean   :3.472   Mean   :2004  
##                                        3rd Qu.:4.600   3rd Qu.:2008  
##                                        Max.   :7.000   Max.   :2008  
##       cyl           trans               drv                 cty       
##  Min.   :4.000   Length:234         Length:234         Min.   : 9.00  
##  1st Qu.:4.000   Class :character   Class :character   1st Qu.:14.00  
##  Median :6.000   Mode  :character   Mode  :character   Median :17.00  
##  Mean   :5.889                                         Mean   :16.86  
##  3rd Qu.:8.000                                         3rd Qu.:19.00  
##  Max.   :8.000                                         Max.   :35.00  
##       hwy             fl               class          
##  Min.   :12.00   Length:234         Length:234        
##  1st Qu.:18.00   Class :character   Class :character  
##  Median :24.00   Mode  :character   Mode  :character  
##  Mean   :23.44                                        
##  3rd Qu.:27.00                                        
##  Max.   :44.00</code></pre>
<p>Berikut adalah deskripsi dari setiap variable dalam data <em>mpg</em>:</p>
<table style="width:97%;">
<colgroup>
<col width="20%" />
<col width="13%" />
<col width="27%" />
<col width="34%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Type</th>
<th>Deskripsi</th>
<th>Detail</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>manufacturer</code></td>
<td>String</td>
<td>Pabrikan mobil</td>
<td>15 Pabrikan</td>
</tr>
<tr class="even">
<td><code>model</code></td>
<td>String</td>
<td>Model mobil</td>
<td>38 Model</td>
</tr>
<tr class="odd">
<td><code>displ</code></td>
<td>Numeric</td>
<td>Ukuran mesin</td>
<td>1.6 - 7.0 liter</td>
</tr>
<tr class="even">
<td><code>year</code></td>
<td>Integer</td>
<td>Tahun pembuatan</td>
<td>1999, 2008</td>
</tr>
<tr class="odd">
<td><code>cyl</code></td>
<td>Integer</td>
<td>Jumlah silinder</td>
<td>4,5,6,8</td>
</tr>
<tr class="even">
<td><code>trans</code></td>
<td>String</td>
<td>Type transmisi</td>
<td>automatic, manual</td>
</tr>
<tr class="odd">
<td><code>drv</code></td>
<td>String</td>
<td>Pergerakan roda</td>
<td>f (front-wheel drive), r (rear wheel drive), 4 (4wd)</td>
</tr>
<tr class="even">
<td><code>cty</code></td>
<td>Integer</td>
<td>Efisiensi bahan bakar di dalam kota</td>
<td>miles per galon</td>
</tr>
<tr class="odd">
<td><code>hwy</code></td>
<td>Integer</td>
<td>Efisiensi bahan bakar di tol</td>
<td>miles per galon</td>
</tr>
<tr class="even">
<td><code>fl</code></td>
<td>String</td>
<td>Type bahan bakar</td>
<td>5 Type</td>
</tr>
<tr class="odd">
<td><code>class</code></td>
<td>String</td>
<td>Type mobil</td>
<td>7 Type</td>
</tr>
</tbody>
</table>
<div id="scatterplot" class="section level2">
<h2>Scatterplot</h2>
<p>Pada bagian ini, kita akan membuat scatterplot antara <code>displ</code> dan <code>hwy</code>.</p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy))</code></pre>
<p><img src="/blog/2019-11-20-visualisasi-dengan-ggplot2_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Pembuatan plot dimulai dari membentuk kordinat sistem dengan menggunakan fungsi <code>ggplot()</code>, lalu ditumpuk dengan beberapa lapisan/layer. Dalam contoh diatas, <code>ggplot(data = mpg)</code> berarti kita akan membuat kordinat sistem menggunakan dataset <em>mpg</em> (masih grafik kosong). Lalu kita menambahkan lapisan <code>geom_point()</code> untuk membuat scatterplot. Setiap fungsi geom di ggplot2 memiliki argumen <code>mapping</code> yang selalu berpasangan dengan <code>aes()</code> atau aesthetic yang memetakan <code>displ</code> ke sumbu-x dan <code>hwy</code>ke sumbu-y.</p>
<p>Kita bisa menambahkan beberapa variable ke dalam scatterplot diatas, misalnya kita ingin mengetahui type mobil (<code>class</code>) mana saja yang ada di scatterplot diatas dan tiap type mobil dibedakan berdasarkan warna. Maka kita bisa menambahkan <code>color=class</code> ke dalam <code>aes()</code>, menjadi sebagai berikut</p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, color = class))</code></pre>
<p><img src="/blog/2019-11-20-visualisasi-dengan-ggplot2_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Jika kita mengganti <code>color=class</code> dengan <code>size=class</code>, maka pembedaan type mobil divisualkan dengan ukuran plotnya</p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, size = class))</code></pre>
<p><img src="/blog/2019-11-20-visualisasi-dengan-ggplot2_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Jika kita mengganti <code>color=class</code> dengan <code>shape=class</code>, maka type mobil dibedakan dengan bentuk plotnya</p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, shape = class))</code></pre>
<p><img src="/blog/2019-11-20-visualisasi-dengan-ggplot2_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div id="facets" class="section level3">
<h3>Facets</h3>
<p>Selain dengan menambahkan variable ke dalam <code>aes()</code>, khusus untuk categorical variable, kita bisa membagi scatterplot untuk tiap type mobil dengan menggunakan <code>facet</code>. Untuk membagi scatterplot dengan satu variable, kita bisa menggunakan <code>facet_wrap()</code> sebagai berikut</p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, color = class)) +
  facet_wrap(~class, ncol = 4)</code></pre>
<p><img src="/blog/2019-11-20-visualisasi-dengan-ggplot2_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Pada plot diatas, scatterplot dibagi untuk tiap type mobil berdasarkan <code>class</code>. Disini, subplot disajikan dengan maksimum 4 kolom.</p>
<p>Facet juga bisa digunakan untuk dua categorical variable, misal kita ingin melihat scatterplot berdasarkan jumlah silinder <code>cyl</code> dan pergerakan roda <code>drv</code>. Hal ini bisa dilakukan dengan menambahkan <code>facet_grid()</code> sebagai berikut</p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_grid(cyl ~ drv)</code></pre>
<p><img src="/blog/2019-11-20-visualisasi-dengan-ggplot2_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="penambahan-garis" class="section level3">
<h3>Penambahan garis</h3>
<p>Misal, kita ingin menambahkan smooth line ke dalam scatterplot yang telah dibuat diatas. Hal ini bisa dilakukan dengan menambah lapisan <code>geom_smooth()</code> ke fungsi <code>ggplot()</code>.</p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), color = &quot;blue&quot;) +
  geom_smooth(mapping = aes(x = displ, y = hwy), method = &quot;loess&quot;, se=FALSE, color=&quot;blue&quot; )</code></pre>
<p><img src="/blog/2019-11-20-visualisasi-dengan-ggplot2_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), color = &quot;darkgreen&quot;) +
  geom_smooth(mapping = aes(x = displ, y = hwy), method = &quot;lm&quot;, se=TRUE, color=&quot;darkgreen&quot; )</code></pre>
<p><img src="/blog/2019-11-20-visualisasi-dengan-ggplot2_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<p>Pada panel pertama, smooth line dengan methode loess <code>method=loess</code> digunakan untuk fit data, untuk plot ini confidence interval tidak ditampilkan <code>se=FALSE</code>. Untuk panel kedua, kita menggunakan metode linear model <code>method=lm</code>dan confidence interval ditampilkan <code>se=TRUE</code>. Kita juga bisa memilih warna secara manual dengan mengeset <code>color=&quot;blue&quot;</code> atau <code>color=&quot;darkgreen&quot;</code>.</p>
<p><code>geom_smooth()</code>dapat juga digunakan untuk group yang berbeda, misal kita ingin melihat smooth line dari mobil berdasarkan type pergerakan roda</p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), color = &quot;steelblue&quot;) +
  geom_smooth(mapping = aes(x = displ, y = hwy, color = drv), method = &quot;loess&quot;, se=TRUE) </code></pre>
<p><img src="/blog/2019-11-20-visualisasi-dengan-ggplot2_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Gambar diatas menampilkan scatterplot beserta smooth line untuk tiap type pergerakan roda.</p>
</div>
</div>
<div id="bar-chart" class="section level2">
<h2>Bar chart</h2>
<p>Pada bagian ini, kita akan membuat bar chart untuk jumlah mobil pada tiap pabrikan dengan menggunakan <code>geom_bar()</code></p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_bar(mapping = aes(x=manufacturer, fill = class)) +
  coord_flip()</code></pre>
<p><img src="/blog/2019-11-20-visualisasi-dengan-ggplot2_files/figure-html/unnamed-chunk-11-1.png" width="672" /> Barchart diatas menampilkan jumlah mobil untuk tiap pabrikan. Kita bisa mewarnai isi dari bar nya dengan menggunakan <code>fill=class</code>. Untuk grafik diatas warna berdasarkan type mobilnya. Setingan awal untuk barchart diatas adalah manufacturer berada di sumbu-x, namun kita putar 90 derajat agar nama dari tiap pabrikan terbaca jelas. Flip grafik ini diakomodasi oleh <code>coord_flip()</code>. Jika tidak di flip maka tulisan pabrikan akan saling menumpuk.</p>
</div>
<div id="label" class="section level2">
<h2>Label</h2>
<pre class="r"><code>ggplot(mpg) +
  geom_point(aes(x = displ, y = hwy, color = class)) +
  geom_smooth(aes(x = displ, y = hwy), se = TRUE) +
  labs(
    title = &quot;Efisiensi bahan bakar menurun sesuai dengan ukuran mesin&quot;,
    subtitle = &quot;Pengecualian untuk two seaters (sports cars) karena bobot yang ringan&quot;,
    caption = &quot;Data dari fueleconomy.gov&quot;,
    x = &quot;Ukuran mesin (L)&quot;,
    y = &quot;Efisiensi bahan bakar di dalam tol (mpg)&quot;,
    colour = &quot;Type mobil&quot;)</code></pre>
<p><img src="/blog/2019-11-20-visualisasi-dengan-ggplot2_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Kita bisa mengubah dan juga menambahkan beberapa label ke dalam suatu plot dengan menggunakan <code>labs()</code>. Untuk grafik diatas, kita menambahkan judul (<code>title</code>), subjudul (<code>subtitle</code>) yang memiliki ukuran huruf lebih kecil dari judul, serta <code>caption</code> yang berada di kanan bawah plot biasanya digunakan untuk mencantumkan sumber data. Selain itu kita juga mengubah beberapa label seperti label sumbu-x, sumbu-y, dan warna label type mobil.</p>
<p>Kita juga bisa mengganti label plot dengan menggunakan persamaan matematika. hal ini bisa dilakukan dengan mengganti <code>&quot;&quot;</code> dengan <code>quote()</code> seperti contoh dibawah ini. Info lebih lanjut bisa dilihat di <code>?plotmath</code>.</p>
<pre class="r"><code>df &lt;- data.frame(
  x = runif(50),
  y = runif(50)
)
ggplot(df) +
  geom_point(aes(x, y)) +
  labs(
    x = quote(sum(x[i] ^ 2, i == 1, n)),
    y = quote(alpha + beta + frac(delta, theta))
  )</code></pre>
<p><img src="/blog/2019-11-20-visualisasi-dengan-ggplot2_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="penutup" class="section level2">
<h2>Penutup</h2>
<p>Tulisan ini memuat langkah awal dalam menyajikan data secara visual dengan menggunakan R package <strong>ggplot2</strong>. Penyajian data berupa scatterplot dan barplot dibahas dalam tulisan ini. Selain itu, pembahasan tentang penyajian data khusus untuk categorical variable juga dilakukan. Penambahan serta pengubahan label untuk sebuah plot juga disajikan. Tulisan ini hanya sebagai dasar untuk membuat visualisasi dengan <strong>ggplot2</strong>, tentunya masih banyak lagi fungsi dan grafik yang bisa digunakan.</p>
<p>Terimakasih telah membaca tulisan ini!</p>
<div id="cheat-sheet" class="section level3">
<h3>Cheat sheet</h3>
<p>Teman-teman bisa melihat <a href="https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf">cheatsheet</a> dari <strong>ggplot2</strong> untuk informasi yang lebih lengkap.</p>
</div>
<div id="referensi" class="section level3">
<h3>Referensi</h3>
<p><strong>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data. Hadley Wickham and Garrett Grolemund</strong></p>
</div>
</div>
